<%-include('../user/layouts/user-header.ejs') %>

	<div class="container">
		<div class="row no-gutters slider-text align-items-center justify-content-center">
			<div class="col-md-9 ftco-animate text-center">
				<h1 class="mb-0 bread">Checkout</h1>
			</div>
		</div>
	</div>

	<section class="ftco-section">
		<div class="container-fluid">
			<div class="row justify-content-center mx-md-3">
			<p class="ml-5"></p>

				<form class="row" action="/place-order" id="checkout_form" method="post">
				<div class="col-md-7 col-lg-8">
					<div class="row">
						<div class="col-md-12 d-flex justify-content-between my-2">
						<h3 class="mb-4 billing-heading">Shipping Address</h3>
						<a href="/address-add" class="btn btn-primary pt-3">Add new Address</a>
						</div>
						<div class="col-md-12 d-flex mb-5">
							<div class="cart-detail cart-total p-3 overflow-auto"
							style="max-width: 800px; max-height: 300px;">
								<% addresses.forEach((addr)=>{ %>
									<div class="row border-bottom p-3">
										<div class="col-sm-9">
											<p>
												<b>
													<%= addr.fullname %>,<%= addr.company %>
												</b><br>
												<b>
													<%= addr.mobile %>,<%= addr.email %>
												</b><br>
												<%= addr.address %>,<%= addr.zip %> <br>
												<%= addr.town %>,<%= addr.state %>,<%= addr.country %> <br>
											</p>
										</div>
										<div class="col-sm-3 d-flex justify-content-around align-items-center">
											<a href="/address-edit/<%= addr._id %>">
												<i class="bi bi-pencil-square" style="color: #0d6efd; font-size: large;"
													title="edit"></i>
											</a>
											<a href="/address-delete/<%= addr._id %>">
												<i class="bi bi-trash-fill" style="color: #cf0000; font-size: large;"
													title="delete"></i>
											</a>
											<input type="radio" id="" name="shipAddrId" value="<%= addr._id %>" required>
										</div>
									</div>
									<% }) %>
							</div>
						</div>

						<h3 class="mb-4 billing-heading">Billing Address</h3>

						<div class="col-md-12 d-flex mb-3 ">
							<div class="cart-detail cart-total p-3 p-md-4 overflow-auto" 
							style="max-width: 800px; max-height: 300px;">
								<% addresses.forEach((addr)=>{ %>
									<div class="row border-bottom p-3">
										<div class="col-sm-9">
											<p>
												<b>
													<%= addr.fullname %>,<%= addr.company %>
												</b><br>
												<b>
													<%= addr.mobile %>,<%= addr.email %>
												</b><br>
												<%= addr.address %>,<%= addr.zip %> <br>
												<%= addr.town %>,<%= addr.state %>,<%= addr.country %> <br>
											</p>
										</div>
										<div class="col-sm-3 d-flex justify-content-around align-items-center">
											<a href="/address-edit/<%= addr._id %>">
												<i class="bi bi-pencil-square" style="color: #0d6efd; font-size: large;"
													title="edit"></i>
											</a>
											<a href="/address-delete/<%= addr._id %>">
												<i class="bi bi-trash-fill" style="color: #cf0000; font-size: large;"
													title="delete"></i>
											</a>
											<input type="radio" id="" name="billAddrId" value="<%= addr._id %>" required>
										</div>
									</div>
									<% }) %>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-5 col-lg-4">
					<div class="row mt-3 pt-3">
						<div class="col-12 d-flex mb-5">
							<div class="cart-detail cart-total p-3 p-md-4">
								<h3 class="billing-heading mb-4">Coupon</h3>
								<p id="err_message" class="text-danger"></p>
								<input type="text" id="coupon" name="coupon" class="form-control form-control-user" style="text-transform: uppercase;"/>
								<div class="d-flex justify-content-between">
								<button type="button" class="btn btn-primary my-2" id="apply-coupon" style="width:40%" onclick="applyCoupon()">Apply</button>
								<button type="button" class="btn btn-primary my-2" id="apply-coupon" style="width:40%" onclick="removeCoupon()">Remove</button>
								</div>
							<p id="success_msg" class="text-success"></p>
							</div>
						</div>
						<div class="col-12 d-flex mb-3">
							<div class="cart-detail cart-total p-3 p-md-4">
								<h3 class="billing-heading mb-4">Cart Total</h3>
								<p class="d-flex">
									<span>Total</span>
									$<span><%= subtotal %></span>
								</p>
								<p class="d-flex">
									<span>Delivery</span>
									$<span>0.00</span>
								</p>
								<p class="d-flex">
									<span>Discount</span>
									$<span id="discount">0.00</span>
								</p>
								<hr>
								<p class="d-flex total-price">
									<span>GrandTotal</span>
									$<span id="grand_total"><%= subtotal %></span>
								</p>
							</div>
						</div>
						<div class="col-12 d-flex flex-column mb-3">
							<h3 class="billing-heading mb-4">Payment Method</h3>
							<div class="form-group">
								<div class="col-md-12">
									<div class="radio">
										<label><input type="radio" name="payment" class="mr-2" value="card" required>Online Payment</label>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="col-md-12">
									<div class="radio">
										<label><input type="radio" name="payment" class="mr-2" value="cod" required>Cash On Delivery</label>
									</div>
								</div>
							</div>
						</div>
					</div>
				<button type="submit" class="btn btn-primary py-3 px-4" id="place-order">Place Order</button>
				</div>
			</form>
			</div>
		</div>
	</section> <!-- .section -->

	<%-include('../user/layouts/user-footer.ejs') %>
	<%-include('../user/layouts/user-script.ejs') %>